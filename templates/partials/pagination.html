{% load pagination_tags humanize %}

{% if page_obj.has_other_pages or show_info %}
<div class="pagination-wrapper">
    {% if show_info and page_obj.paginator.count > 0 %}
    <div class="pagination-info">
        <span class="pagination-showing">
            Showing <strong>{{ start_index|intcomma }}</strong> - <strong>{{ end_index|intcomma }}</strong> of <strong>{{ total_count|intcomma }}</strong> results
        </span>
    </div>
    {% endif %}
    
    {% if page_obj.has_other_pages %}
    <nav aria-label="Page navigation" class="pagination-nav">
        <ul class="pagination pagination-modern justify-content-center mb-0 flex-wrap">
            <!-- First Page -->
            <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
                <a class="page-link page-link-nav" 
                   href="{% if page_obj.has_previous %}{% page_url 1 %}{% else %}#{% endif %}" 
                   title="First page"
                   {% if not page_obj.has_previous %}tabindex="-1" aria-disabled="true"{% endif %}>
                    <i class="las la-angle-double-left"></i>
                    <span class="d-none d-sm-inline ms-1">First</span>
                </a>
            </li>
            
            <!-- Previous Page -->
            <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
                <a class="page-link page-link-nav" 
                   href="{% if page_obj.has_previous %}{% page_url page_obj.previous_page_number %}{% else %}#{% endif %}" 
                   title="Previous page"
                   {% if not page_obj.has_previous %}tabindex="-1" aria-disabled="true"{% endif %}>
                    <i class="las la-angle-left"></i>
                    <span class="d-none d-md-inline ms-1">Prev</span>
                </a>
            </li>
            
            <!-- Page Numbers -->
            {% for page_num in page_numbers %}
                {% if page_num == '...' %}
                <li class="page-item disabled d-none d-sm-block">
                    <span class="page-link page-ellipsis">â€¦</span>
                </li>
                {% else %}
                <li class="page-item {% if page_num == page_obj.number %}active{% endif %} {% if page_num != page_obj.number and page_num != 1 and page_num != page_obj.paginator.num_pages %}d-none d-sm-block{% endif %}">
                    <a class="page-link page-link-number" 
                       href="{% page_url page_num %}"
                       {% if page_num == page_obj.number %}aria-current="page"{% endif %}>
                        {{ page_num }}
                    </a>
                </li>
                {% endif %}
            {% endfor %}
            
            <!-- Next Page -->
            <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
                <a class="page-link page-link-nav" 
                   href="{% if page_obj.has_next %}{% page_url page_obj.next_page_number %}{% else %}#{% endif %}" 
                   title="Next page"
                   {% if not page_obj.has_next %}tabindex="-1" aria-disabled="true"{% endif %}>
                    <span class="d-none d-md-inline me-1">Next</span>
                    <i class="las la-angle-right"></i>
                </a>
            </li>
            
            <!-- Last Page -->
            <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
                <a class="page-link page-link-nav" 
                   href="{% if page_obj.has_next %}{% page_url page_obj.paginator.num_pages %}{% else %}#{% endif %}" 
                   title="Last page"
                   {% if not page_obj.has_next %}tabindex="-1" aria-disabled="true"{% endif %}>
                    <span class="d-none d-sm-inline me-1">Last</span>
                    <i class="las la-angle-double-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    
    <!-- Mobile Page Indicator -->
    <div class="pagination-mobile-info d-sm-none text-center mt-2">
        <small class="text-muted">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</small>
    </div>
    {% endif %}
    
    {% if page_obj.paginator.num_pages > 10 %}
    <!-- Quick Jump (for large datasets) -->
    <div class="pagination-jump d-none d-md-flex">
        <label class="pagination-jump-label" for="pageJumpInput">Go to page:</label>
        <input type="number" 
               class="form-control form-control-sm pagination-jump-input" 
               id="pageJumpInput"
               min="1" 
               max="{{ page_obj.paginator.num_pages }}" 
               value="{{ page_obj.number }}"
               aria-label="Jump to page">
        <button type="button" class="btn btn-sm btn-outline-primary pagination-jump-btn" onclick="jumpToPage()">
            <i class="las la-arrow-right"></i>
        </button>
    </div>
    <script>
    function jumpToPage() {
        const input = document.getElementById('pageJumpInput');
        const page = parseInt(input.value);
        const maxPage = {{ page_obj.paginator.num_pages }};
        if (page >= 1 && page <= maxPage) {
            const url = new URL(window.location.href);
            url.searchParams.set('page', page);
            window.location.href = url.toString();
        }
    }
    document.getElementById('pageJumpInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            jumpToPage();
        }
    });
    </script>
    {% endif %}
</div>
{% elif page_obj.paginator.count == 0 %}
<!-- Empty state - no pagination needed -->
{% endif %}
